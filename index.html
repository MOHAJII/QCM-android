<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Android Interactif</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* (Vos styles existants restent les mêmes) */
        
        .section-selector {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .section-checkbox {
            display: none;
        }
        
        .section-label {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .section-label:hover {
            background: linear-gradient(145deg, #e3f2fd, #bbdefb);
            transform: translateX(5px);
        }
        
        .section-checkbox:checked + .section-label {
            background: linear-gradient(145deg, #2196f3, #1976d2);
            color: white;
            border-color: #0d47a1;
        }
        
        .section-info {
            font-size: 0.9em;
            color: #666;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="quiz-container p-4 mt-4">
            <!-- Header -->
            <div class="text-center mb-4">
                <i class="fab fa-android android-icon"></i>
                <h1 class="display-4 fw-bold text-primary mb-3">Quiz Android Interactif</h1>
                <p class="lead text-muted">Testez vos connaissances en développement Android</p>
            </div>
            
            <!-- Start Screen -->
            <div id="startScreen" class="text-center">
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card question-card p-4">
                            <h3 class="mb-4">Prêt à commencer ?</h3>
                            <p class="mb-4">Ce quiz contient 100 questions sur Android réparties en 5 sections :</p>
                            
                            <!-- Section Selection -->
                            <div class="section-selector mb-4">
                                <h5 class="mb-3">Choisissez les sections à inclure :</h5>
                                
                                <input type="checkbox" id="section1" class="section-checkbox" checked>
                                <label for="section1" class="section-label">
                                    <strong>Section 1: Bases d'Android</strong>
                                    <span class="section-info">(20 questions)</span>
                                </label>
                                
                                <input type="checkbox" id="section2" class="section-checkbox" checked>
                                <label for="section2" class="section-label">
                                    <strong>Section 2: Interface Utilisateur</strong>
                                    <span class="section-info">(20 questions)</span>
                                </label>
                                
                                <input type="checkbox" id="section3" class="section-checkbox" checked>
                                <label for="section3" class="section-label">
                                    <strong>Section 3: Gestion des Données</strong>
                                    <span class="section-info">(20 questions)</span>
                                </label>
                                
                                <input type="checkbox" id="section4" class="section-checkbox" checked>
                                <label for="section4" class="section-label">
                                    <strong>Section 4: Services et Composants</strong>
                                    <span class="section-info">(20 questions)</span>
                                </label>
                                
                                <input type="checkbox" id="section5" class="section-checkbox" checked>
                                <label for="section5" class="section-label">
                                    <strong>Section 5: Avancé et Optimisation</strong>
                                    <span class="section-info">(20 questions)</span>
                                </label>
                            </div>
                            
                            <button class="btn btn-primary btn-lg" onclick="startQuiz()">
                                <i class="fas fa-play me-2"></i>Commencer le Quiz
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- (Le reste de votre HTML reste inchangé) -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // (Vos questions et sectionNames restent les mêmes)
        
        let currentQuestion = 0;
        let userAnswers = [];
        let score = 0;
        let sectionScores = [0, 0, 0, 0, 0, 0];
        let selectedOption = -1;
        let filteredQuestions = [];
        let selectedSections = [1, 2, 3, 4, 5]; // Par défaut toutes les sections

        function startQuiz() {
            // Récupérer les sections sélectionnées
            selectedSections = [];
            if (document.getElementById('section1').checked) selectedSections.push(1);
            if (document.getElementById('section2').checked) selectedSections.push(2);
            if (document.getElementById('section3').checked) selectedSections.push(3);
            if (document.getElementById('section4').checked) selectedSections.push(4);
            if (document.getElementById('section5').checked) selectedSections.push(5);
            
            // Vérifier qu'au moins une section est sélectionnée
            if (selectedSections.length === 0) {
                alert("Veuillez sélectionner au moins une section !");
                return;
            }
            
            // Filtrer les questions selon les sections sélectionnées
            filteredQuestions = questions.filter(q => selectedSections.includes(q.s));
            
            // Réinitialiser les variables du quiz
            currentQuestion = 0;
            userAnswers = [];
            score = 0;
            sectionScores = [0, 0, 0, 0, 0, 0];
            selectedOption = -1;
            
            // Afficher l'écran du quiz
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';
            loadQuestion();
        }

        function loadQuestion() {
            const q = filteredQuestions[currentQuestion];
            const questionNum = currentQuestion + 1;
            
            // Mettre à jour la progression
            const progress = (questionNum / filteredQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${questionNum}/${filteredQuestions.length}`;
            
            // Mettre à jour la section
            document.getElementById('currentSection').textContent = sectionNames[q.s];
            
            // Mettre à jour la question
            document.getElementById('questionNumber').textContent = `Question ${questionNum}`;
            document.getElementById('questionText').textContent = q.q;
            
            // Mettre à jour le score
            document.getElementById('scoreDisplay').textContent = `Score: ${score}/${currentQuestion}`;
            
            // Créer les options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            q.o.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn option-btn w-100 text-start';
                btn.innerHTML = `<strong>${String.fromCharCode(97 + index)})</strong> ${option}`;
                btn.onclick = () => selectOption(index);
                optionsContainer.appendChild(btn);
            });
            
            // Réinitialiser la sélection
            selectedOption = -1;
            
            // Mettre à jour les boutons de navigation
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').disabled = true;
            document.getElementById('nextBtn').style.display = currentQuestion === filteredQuestions.length - 1 ? 'none' : 'inline-block';
            document.getElementById('finishBtn').style.display = currentQuestion === filteredQuestions.length - 1 ? 'inline-block' : 'none';
        }

        // (Le reste de vos fonctions JavaScript reste inchangé, sauf qu'il faut remplacer 
        // toutes les références à 'questions' par 'filteredQuestions' dans les fonctions)

        function nextQuestion() {
            if (selectedOption === -1) return;
            
            // Stocker la réponse
            userAnswers[currentQuestion] = selectedOption;
            
            // Vérifier si la réponse est correcte
            if (selectedOption === filteredQuestions[currentQuestion].a) {
                score++;
                sectionScores[filteredQuestions[currentQuestion].s]++;
            }
            
            // Afficher la réponse correcte avec animation
            showAnswerFeedback();
            
            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < filteredQuestions.length) {
                    loadQuestion();
                } else {
                    finishQuiz();
                }
            }, 1500);
        }

        function showResults() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            
            // Calculer le pourcentage
            const percentage = Math.round((score / filteredQuestions.length) * 100);
            document.getElementById('finalScore').textContent = `${score}/${filteredQuestions.length} (${percentage}%)`;
            
            // (Le reste de la fonction showResults reste inchangé)
        }

        // (Les autres fonctions restent les mêmes, avec les mêmes modifications pour utiliser filteredQuestions)
    </script>
</body>
</html>
